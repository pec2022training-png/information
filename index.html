<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¬å¸è¯çµ¡äººå›é¥‹ç®¡ç†ç³»çµ± - é€²éšç¢ºèªç‰ˆ</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

    <style>
        body { font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 1450px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #1a73e8; border-bottom: 2px solid #e8f0fe; padding-bottom: 15px; margin: 0 0 20px 0; }
        
        .login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); display: flex; justify-content: center; align-items: center; z-index: 1000; }
        .login-box { background: white; padding: 30px; border-radius: 12px; width: 400px; box-shadow: 0 10px 25px rgba(0,0,0,0.5); }
        
        .inline-input { width: 100%; padding: 8px; border: 1px solid #1a73e8; border-radius: 4px; box-sizing: border-box; font-size: 0.9rem; margin-bottom: 5px; }
        .inline-input:disabled { background-color: #f5f5f5; border: 1px solid #ddd; color: #888; }
        
        .btn { padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85rem; transition: 0.2s; font-weight: 500; display: inline-flex; align-items: center; justify-content: center; gap: 5px; }
        .btn-primary { background: #1a73e8; color: white; }
        .btn-success { background: #34a853; color: white; }
        .btn-danger { background: #ea4335; color: white; }
        .btn-secondary { background: #70757a; color: white; }
        .btn-warning { background: #fbbc04; color: #333; }
        .btn-confirm { background: #673ab7; color: white; } /* ç´«è‰²å€åˆ†ç¢ºèªæŒ‰éˆ• */
        .btn-confirm:hover { background: #5e35b1; box-shadow: 0 2px 8px rgba(103,58,183,0.4); }
        .btn-sort { background: #f8f9fa; color: #333; border: 1px solid #ddd; padding: 4px 8px; }

        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.85rem; }
        th, td { border: 1px solid #f1f3f4; padding: 10px; text-align: left; vertical-align: middle; }
        th { background-color: #f8f9fa; position: sticky; top: 0; z-index: 10; color: #555; }
        
        .tag { padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; color: white; font-weight: bold; white-space: nowrap; display: inline-block; }
        .tag-yes { background: #34a853; }
        .tag-no { background: #dadce0; color: #5f6368; }
        tr.editing-row { background-color: #e8f0fe; }

        .status-col { min-width: 180px; }
        .move-btns { display: flex; flex-direction: column; gap: 2px; }

        .admin-settings { background: #fffde7; border: 1px solid #fff59d; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; align-items: center; gap: 15px; }
    </style>
</head>
<body>

<div id="app">
    <div v-if="!isLoggedIn && !isAdmin" class="login-overlay">
        <div class="login-box">
            <h3 style="margin-top:0; text-align: center;">ğŸ¢ è¯çµ¡äººè³‡è¨Šç¶­è­·ç³»çµ±</h3>
            
            <div v-if="!isPasswordVerified">
                <div style="margin-bottom: 15px;">
                    <label>è«‹è¼¸å…¥ç³»çµ±å­˜å–å¯†ç¢¼ï¼š</label>
                    <input type="password" v-model="inputAccessPassword" placeholder="æ­¤å¯†ç¢¼ç”±ç®¡ç†è€…æä¾›" class="inline-input" style="font-size: 1rem; margin-top:10px;" @keyup.enter="verifyAccessPassword">
                </div>
                <button class="btn btn-primary" style="width: 100%; padding: 10px;" @click="verifyAccessPassword">é©—è­‰å¯†ç¢¼</button>
            </div>

            <div v-else>
                <div style="margin-bottom: 15px;">
                    <label>è«‹è¼¸å…¥å…¬å¸çµ±ä¸€ç·¨è™Ÿ (8ç¢¼)ï¼š</label>
                    <input type="text" v-model="loginTaxId" maxlength="8" @input="autoSearchCompany" class="inline-input" style="font-size: 1rem; margin-top:10px;">
                </div>
                <div v-if="/^\d{8}$/.test(loginTaxId)">
                    <div style="margin-bottom: 10px;"><label>å…¬å¸åç¨±ï¼š</label><input type="text" v-model="editorInfo.company" class="inline-input"></div>
                    <div style="margin-bottom: 10px;"><label>ç·¨ä¿®äººå§“åï¼š</label><input type="text" v-model="editorInfo.name" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" class="inline-input"></div>
                    <div style="margin-bottom: 15px;"><label>ç·¨ä¿®äººåˆ†æ©Ÿï¼š</label><input type="text" v-model="editorInfo.ext" placeholder="è«‹è¼¸å…¥åˆ†æ©Ÿ" class="inline-input"></div>
                    <button class="btn btn-success" style="width: 100%; padding: 10px;" @click="login">ç¢ºèªé€²å…¥ç·¨ä¿®</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div v-if="isAdmin" class="admin-settings">
            <strong>ğŸ”‘ ç®¡ç†ç«¯ - è¨­å®šç·¨ä¿®å¯†ç¢¼ï¼š</strong>
            <input type="text" v-model="newSystemPassword" placeholder="è¨­å®šæ–°å¯†ç¢¼" class="inline-input" style="width: 200px; margin-bottom:0;">
            <button class="btn btn-warning" @click="saveSystemPassword">æ›´æ–°å¯†ç¢¼</button>
            <span style="font-size: 0.8rem; color: #666;">(ç›®å‰å¯†ç¢¼ï¼š{{ systemPassword }})</span>
        </div>

        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
            <div>
                <h2>{{ isAdmin ? 'ğŸ’ ç³»çµ±ç®¡ç†å“¡å¾Œå°' : 'ğŸ“ è²´å…¬å¸è¯çµ¡è³‡è¨Šå›é¥‹' }}</h2>
                <p v-if="isLoggedIn && !isAdmin" style="color: #666; margin:0;">
                    çµ±ç·¨ï¼š<strong>{{ currentTaxId }}</strong> | å…¬å¸ï¼š<strong>{{ editorInfo.company }}</strong><br>
                    äººå“¡ï¼š<strong>{{ editorInfo.name }} (åˆ†æ©Ÿ: {{ editorInfo.ext }})</strong>
                </p>
                <p v-else-if="isAdmin" style="color: #666; margin:0;">
                    <small>ğŸ’¡ ç®¡ç†å“¡æ¨¡å¼ï¼šå¯æŸ¥çœ‹æ‰€æœ‰å…¬å¸å›é¥‹ç‹€æ…‹èˆ‡é€²è¡Œ Excel æ“ä½œã€‚</small>
                </p>
            </div>
            <div style="display:flex; gap:8px; flex-wrap: wrap; justify-content: flex-end;">
                <button v-if="isLoggedIn && !isAdmin && filteredData.length > 0" class="btn btn-confirm" @click="confirmAllCorrect">
                    âœ… è³‡æ–™æ­£ç¢ºç„¡èª¤ (é€å‡ºç¢ºèª)
                </button>

                <template v-if="isAdmin">
                    <button v-if="selectedIds.length > 0" class="btn btn-danger" @click="batchDelete">ğŸ—‘ï¸ æ‰¹æ¬¡åˆªé™¤ ({{ selectedIds.length }})</button>
                    <button class="btn btn-secondary" @click="triggerImport">ğŸ“¥ åŒ¯å…¥ Excel</button>
                    <input type="file" ref="fileInput" style="display:none" accept=".xlsx, .xls, .csv" @change="handleImport">
                    <button class="btn btn-success" @click="exportExcel">ğŸ“Š åŒ¯å‡º Excel</button>
                </template>
                <button v-if="(isLoggedIn || isAdmin) && !editingId && !isAdding" class="btn btn-primary" @click="startAddNew">â• æ–°å¢è¯çµ¡äºº</button>
            </div>
        </div>

        <table>
            <thead>
                <tr>
                    <th v-if="isAdmin" style="width: 40px; text-align: center;">
                        <input type="checkbox" @change="toggleSelectAll" :checked="isAllSelected">
                    </th>
                    <th style="width: 100px;">çµ±ç·¨</th>
                    <th style="min-width: 180px;">å…¬å¸/å–®ä½</th>
                    <th style="width: 120px;">å§“å/è·ç¨±</th>
                    <th style="min-width: 200px;">è¯ç¹«æ–¹å¼ (å«FAX)</th>
                    <th class="status-col">ç‹€æ…‹ç¢ºèª</th>
                    <th style="width: 120px;">æœ€å¾Œç•°å‹•</th>
                    <th style="width: 140px;">æ“ä½œ/æ’åº</th>
                </tr>
            </thead>
            <tbody>
                <tr v-if="isAdding" class="editing-row">
                    <td v-if="isAdmin"></td>
                    <td><input type="text" v-model="editForm.taxId" class="inline-input" :disabled="!isAdmin"></td>
                    <td>
                        <input type="text" v-model="editForm.compName" class="inline-input" :disabled="!isAdmin">
                        <input type="text" v-model="editForm.dept" class="inline-input" placeholder="å–®ä½">
                    </td>
                    <td>
                        <input type="text" v-model="editForm.name" class="inline-input" placeholder="å§“å">
                        <input type="text" v-model="editForm.title" class="inline-input" placeholder="è·ç¨±">
                    </td>
                    <td>
                        <input type="text" v-model="editForm.phone" class="inline-input" placeholder="é›»è©±">
                        <input type="text" v-model="editForm.fax" class="inline-input" placeholder="FAX">
                        <input type="email" v-model="editForm.email" class="inline-input" placeholder="Email">
                        <input type="text" v-model="editForm.address" class="inline-input" placeholder="åœ°å€">
                    </td>
                    <td>
                        <select v-model="editForm.isTrainer" class="inline-input">
                            <option value="YES">è¨“ç·´ä¸»ç®¡:YES</option>
                            <option value="NO">è¨“ç·´ä¸»ç®¡:NO</option>
                        </select>
                        <select v-model="editForm.sendDM" class="inline-input" style="margin-top:4px;">
                            <option value="YES">å¯„ç™¼DM:YES</option>
                            <option value="NO">å¯„ç™¼DM:NO</option>
                        </select>
                    </td>
                    <td>-</td>
                    <td>
                        <button class="btn btn-success" @click="saveData" style="width:100%; margin-bottom:2px;">å„²å­˜</button>
                        <button class="btn btn-secondary" @click="cancelEdit" style="width:100%;">å–æ¶ˆ</button>
                    </td>
                </tr>

                <tr v-for="(item, index) in filteredData" :key="item.id" :class="{'editing-row': editingId === item.id}">
                    <td v-if="isAdmin" style="text-align: center;">
                        <input type="checkbox" v-model="selectedIds" :value="item.id">
                    </td>
                    <td><span v-else><strong>{{ item.taxId }}</strong></span></td>
                    <td>{{ item.compName }}<br><small style="color:#888">{{ item.dept }}</small></td>
                    <td>
                        <div v-if="editingId === item.id">
                            <input v-model="editForm.name" class="inline-input" placeholder="å§“å">
                            <input v-model="editForm.title" class="inline-input" placeholder="è·ç¨±">
                        </div>
                        <div v-else>{{ item.name }}<br><small style="color:#888">{{ item.title }}</small></div>
                    </td>
                    <td>
                        <div v-if="editingId === item.id">
                            <input v-model="editForm.phone" class="inline-input" placeholder="é›»è©±">
                            <input v-model="editForm.fax" class="inline-input" placeholder="FAX">
                            <input v-model="editForm.email" class="inline-input" placeholder="Email">
                            <input v-model="editForm.address" class="inline-input" placeholder="åœ°å€">
                        </div>
                        <div v-else>
                            ğŸ“ {{ item.phone }}<br>
                            ğŸ“  FAX: {{ item.fax || '-' }}<br>
                            âœ‰ï¸ {{ item.email }}<br>
                            <small>ğŸ“ {{ item.address }}</small>
                        </div>
                    </td>
                    <td>
                        <div v-if="editingId === item.id">
                            <select v-model="editForm.isTrainer" class="inline-input">
                                <option value="YES">è¨“ç·´ä¸»ç®¡:YES</option>
                                <option value="NO">è¨“ç·´ä¸»ç®¡:NO</option>
                            </select>
                            <select v-model="editForm.sendDM" class="inline-input" style="margin-top:4px;">
                                <option value="YES">å¯„ç™¼DM:YES</option>
                                <option value="NO">å¯„ç™¼DM:NO</option>
                            </select>
                        </div>
                        <div v-else>
                            <span :class="['tag', item.isTrainer === 'YES' ? 'tag-yes' : 'tag-no']">è¨“ç·´ä¸»ç®¡:{{ item.isTrainer }}</span><br>
                            <span :class="['tag', item.sendDM === 'YES' ? 'tag-yes' : 'tag-no']" style="margin-top:5px;">å¯„ç™¼DM:{{ item.sendDM }}</span>
                        </div>
                    </td>
                    <td style="font-size: 0.7rem; color: #666; line-height: 1.2;">
                        {{ item.lastEditor }}<br>{{ formatDate(item.updateTime) }}
                    </td>
                    <td>
                        <div v-if="editingId === item.id">
                            <button class="btn btn-success" @click="saveData" style="width:100%; margin-bottom:2px;">å„²å­˜</button>
                            <button class="btn btn-secondary" @click="cancelEdit" style="width:100%;">å–æ¶ˆ</button>
                        </div>
                        <div v-else style="display: flex; gap: 5px; align-items: center;">
                            <div class="move-btns">
                                <button class="btn btn-sort" @click="moveItem(index, -1)">â†‘</button>
                                <button class="btn btn-sort" @click="moveItem(index, 1)">â†“</button>
                            </div>
                            <div style="flex:1">
                                <button class="btn btn-primary" @click="startEdit(item)" style="width:100%; padding:2px; margin-bottom:2px;">æ”¹</button>
                                <button class="btn btn-danger" @click="deleteItem(item.id)" style="width:100%; padding:2px;">åˆª</button>
                            </div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
const { createApp } = Vue;

const firebaseConfig = {
    apiKey: "AIzaSyA97EbUfh620b-Bz2eFeSifptEOBkL_v7U",
    authDomain: "training-76bd2.firebaseapp.com",
    databaseURL: "https://training-76bd2-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "training-76bd2",
    storageBucket: "training-76bd2.firebasestorage.app",
    messagingSenderId: "1032641306025",
    appId: "1:1032641306025:web:a25f74c2bef92268dcf8b8",
    measurementId: "G-EQ84DXPD97"
};

if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const db = firebase.database();

createApp({
    data() {
        return {
            isAdmin: false, isLoggedIn: false, isPasswordVerified: false,
            systemPassword: '', inputAccessPassword: '', newSystemPassword: '',
            loginTaxId: '', currentTaxId: '',
            editorInfo: { company: '', name: '', ext: '' },
            allData: [], editingId: null, isAdding: false, editForm: {}, selectedIds: [],
            fieldMap: {
                'çµ±ä¸€ç·¨è™Ÿ': 'taxId', 'å…¬å¸åç¨±': 'compName', 'å–®ä½': 'dept', 'å§“å': 'name', 'è·ç¨±': 'title',
                'é›»è©±': 'phone', 'åˆ†æ©Ÿ': 'ext', 'FAX': 'fax', 'e-mail': 'email', 'åœ°å€': 'address',
                'è¨“ç·´ä¸»ç®¡æˆ–ä¸»è¾¦(YES/NO)': 'isTrainer', 'æ¯å­£å¯„ç™¼DM(YES/NO)': 'sendDM'
            }
        }
    },
    computed: {
        filteredData() {
            let baseData = this.isAdmin ? this.allData : this.allData.filter(d => String(d.taxId).trim() === String(this.currentTaxId).trim());
            const companyRanks = {};
            this.allData.forEach(item => {
                const tid = String(item.taxId);
                const order = item.order !== undefined ? item.order : 999999;
                if (companyRanks[tid] === undefined || order < companyRanks[tid]) companyRanks[tid] = order;
            });
            return baseData.sort((a, b) => {
                const tidA = String(a.taxId), tidB = String(b.taxId);
                if (tidA !== tidB) return companyRanks[tidA] - companyRanks[tidB];
                return (a.order || 0) - (b.order || 0) || (a.updateTime || 0) - (b.updateTime || 0);
            });
        },
        isAllSelected() { return this.filteredData.length > 0 && this.selectedIds.length === this.filteredData.length; }
    },
    mounted() {
        const urlParams = new URLSearchParams(window.location.search);
        this.isAdmin = urlParams.get('role') === 'admin';
        db.ref('company_contacts').on('value', s => {
            const val = s.val();
            this.allData = val ? Object.keys(val).map(k => ({ id: k, ...val[k] })) : [];
        });
        db.ref('settings/accessPassword').on('value', s => { this.systemPassword = s.val() || '1234'; });
    },
    methods: {
        verifyAccessPassword() {
            if (this.inputAccessPassword === this.systemPassword) this.isPasswordVerified = true;
            else { alert("å¯†ç¢¼éŒ¯èª¤"); this.inputAccessPassword = ''; }
        },
        saveSystemPassword() {
            if (!this.newSystemPassword.trim()) return alert("è«‹è¼¸å…¥å¯†ç¢¼");
            db.ref('settings/accessPassword').set(this.newSystemPassword.trim()).then(() => {
                alert("å¯†ç¢¼å·²æ›´æ–°"); this.newSystemPassword = '';
            });
        },
        autoSearchCompany() {
            if (this.loginTaxId.length === 8) {
                const found = this.allData.find(d => String(d.taxId).trim() === this.loginTaxId.trim());
                if (found) this.editorInfo.company = found.compName;
            }
        },
        login() { 
            if (!this.editorInfo.company.trim() || !this.editorInfo.name.trim()) return alert("è«‹å¡«å¯«å®Œæ•´è³‡è¨Š");
            this.currentTaxId = this.loginTaxId.trim(); this.isLoggedIn = true; 
        },
        // æ–°åŠŸèƒ½ï¼šç¢ºèªç„¡èª¤æŒ‰éˆ•
        async confirmAllCorrect() {
            if (!confirm(`ç¢ºå®šè²´å…¬å¸ã€Œ${this.editorInfo.company}ã€çš„æ‰€æœ‰è¯çµ¡è³‡æ–™çš†æ­£ç¢ºç„¡èª¤å—ï¼Ÿ\nç³»çµ±å°‡æœƒé€å‡ºç¢ºèªè¨»è¨˜ã€‚`)) return;
            
            const editorTag = `${this.editorInfo.name}${this.editorInfo.ext ? `(åˆ†æ©Ÿ:${this.editorInfo.ext})` : ''} [ç¢ºèªç„¡éœ€èª¿æ•´]`;
            const timestamp = Date.now();
            
            const updates = {};
            this.filteredData.forEach(item => {
                updates[`company_contacts/${item.id}/lastEditor`] = editorTag;
                updates[`company_contacts/${item.id}/updateTime`] = timestamp;
            });

            try {
                await db.ref().update(updates);
                alert("å·²æˆåŠŸé€å‡ºç¢ºèªï¼è¬è¬æ‚¨çš„å”åŠ©ã€‚");
            } catch (err) {
                alert("é€å‡ºå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šã€‚");
            }
        },
        toggleSelectAll(e) { this.selectedIds = e.target.checked ? this.filteredData.map(d => d.id) : []; },
        async batchDelete() {
            if (this.selectedIds.length === 0) return;
            if (confirm(`ç¢ºå®šåˆªé™¤é€™ ${this.selectedIds.length} ç­†è³‡æ–™ï¼Ÿ`)) {
                const promises = this.selectedIds.map(id => db.ref(`company_contacts/${id}`).remove());
                await Promise.all(promises);
                this.selectedIds = [];
            }
        },
        async moveItem(index, direction) {
            const targetIndex = index + direction;
            if (targetIndex < 0 || targetIndex >= this.filteredData.length) return;
            const currentItem = this.filteredData[index], targetItem = this.filteredData[targetIndex];
            if (currentItem.taxId !== targetItem.taxId) return;
            let cOrder = currentItem.order || 0, tOrder = targetItem.order || 0;
            if (cOrder === tOrder) tOrder = cOrder + direction;
            await db.ref(`company_contacts/${currentItem.id}`).update({ order: tOrder });
            await db.ref(`company_contacts/${targetItem.id}`).update({ order: cOrder });
        },
        startAddNew() {
            this.isAdding = true; this.editingId = null;
            const tid = this.isAdmin ? '' : this.currentTaxId;
            const cname = this.isAdmin ? '' : this.editorInfo.company;
            const maxOrder = this.allData.length > 0 ? Math.max(...this.allData.map(d => d.order || 0)) : 0;
            this.editForm = { taxId: tid, compName: cname, dept: '', name: '', title: '', phone: '', fax: '', email: '', address: '', isTrainer: 'NO', sendDM: 'NO', order: maxOrder + 1 };
        },
        startEdit(item) { this.editingId = item.id; this.isAdding = false; this.editForm = JSON.parse(JSON.stringify(item)); },
        cancelEdit() { this.editingId = null; this.isAdding = false; },
        saveData() {
            if (!this.editForm.taxId || !this.editForm.compName || !this.editForm.name) return alert("å¿…å¡«æ¬„ä½ç¼ºå¤±");
            const editorTag = this.isAdmin ? 'ç®¡ç†å“¡' : `${this.editorInfo.name}${this.editorInfo.ext ? `(åˆ†æ©Ÿ:${this.editorInfo.ext})` : ''} [æ›´æ–°]`;
            const payload = { ...this.editForm, updateTime: Date.now(), lastEditor: editorTag };
            const id = payload.id; delete payload.id;
            if (id) db.ref(`company_contacts/${id}`).update(payload);
            else db.ref('company_contacts').push(payload);
            this.cancelEdit();
        },
        deleteItem(id) { if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) db.ref(`company_contacts/${id}`).remove(); },
        triggerImport() { this.$refs.fileInput.click(); },
        handleImport(e) {
            const file = e.target.files[0], reader = new FileReader();
            reader.onload = (ev) => {
                const workbook = XLSX.read(new Uint8Array(ev.target.result), { type: 'array' });
                const json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]], { defval: "" });
                json.forEach((row, index) => {
                    const newDoc = {};
                    Object.keys(this.fieldMap).forEach(zh => { 
                        let val = String(row[zh] || '').trim();
                        if (zh.includes('YES/NO')) val = val.toUpperCase().includes('Y') ? 'YES' : 'NO';
                        newDoc[this.fieldMap[zh]] = val; 
                    });
                    newDoc.updateTime = Date.now(); newDoc.lastEditor = "ExcelåŒ¯å…¥"; newDoc.order = index; 
                    if (newDoc.taxId) db.ref('company_contacts').push(newDoc);
                });
                alert('åŒ¯å…¥å®Œæˆ'); e.target.value = '';
            };
            reader.readAsArrayBuffer(file);
        },
        exportExcel() {
            const rows = this.filteredData.map(item => ({
                'çµ±ä¸€ç·¨è™Ÿ': item.taxId, 'å…¬å¸åç¨±': item.compName, 'å–®ä½': item.dept, 'å§“å': item.name, 'è·ç¨±': item.title,
                'é›»è©±': item.phone, 'åˆ†æ©Ÿ': item.ext, 'FAX': item.fax, 'e-mail': item.email, 'åœ°å€': item.address,
                'è¨“ç·´ä¸»ç®¡æˆ–ä¸»è¾¦(YES/NO)': item.isTrainer, 'æ¯å­£å¯„ç™¼DM(YES/NO)': item.sendDM,
                'æœ€å¾Œç•°å‹•äºº': item.lastEditor, 'ç•°å‹•æ™‚é–“': this.formatDate(item.updateTime)
            }));
            const ws = XLSX.utils.json_to_sheet(rows);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Data");
            XLSX.writeFile(wb, `è¯çµ¡äººè³‡æ–™åº«_${new Date().toLocaleDateString()}.xlsx`);
        },
        formatDate(ms) { return ms ? new Date(ms).toLocaleString() : '-'; }
    }
}).mount('#app');
</script>
</body>
</html>
