<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>管理員後台 - 批次操作功能</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* 基礎樣式模擬您的介面 */
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #f8f9fa; padding: 20px; }
        .header-actions { display: flex; justify-content: flex-end; gap: 10px; margin-bottom: 20px; }
        .btn { padding: 8px 15px; border-radius: 5px; cursor: pointer; border: none; font-weight: bold; color: white; transition: 0.3s; }
        .btn-blue { background-color: #2b7de9; }
        .btn-green { background-color: #4caf50; }
        .btn-red { background-color: #e53935; }
        .btn-grey { background-color: #757575; }
        
        /* 批次操作列 - 預設隱藏 */
        #batch-bar {
            display: none;
            background-color: #fff3cd;
            padding: 15px;
            border-left: 5px solid #ffc107;
            margin-bottom: 15px;
            align-items: center;
            justify-content: space-between;
            border-radius: 4px;
        }

        table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        th, td { padding: 12px; border-bottom: 1px solid #eee; text-align: left; }
        th { background-color: #fdfdfd; color: #555; }
        .selected-row { background-color: #f0f7ff !important; } /* 選中時的背景色 */
    </style>
</head>
<body>

    <h2><i class="fas fa-gem" style="color:#2b7de9"></i> 系統管理員後台</h2>

    <div class="header-actions">
        <button class="btn btn-grey">匯入 Excel</button>
        <button class="btn btn-green">匯出 Excel</button>
        <button class="btn btn-red" onclick="safeClearDatabase()">清空資料庫</button>
        <button class="btn btn-blue">+ 新增聯絡人</button>
    </div>

    <div id="batch-bar">
        <div>已經選取 <span id="selected-count" style="color:red; font-weight:bold;">0</span> 筆資料</div>
        <div>
            <button class="btn btn-green" onclick="batchExport()">匯出選中項</button>
            <button class="btn btn-red" onclick="batchDelete()">批次刪除</button>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th><input type="checkbox" id="select-all" onclick="toggleAll(this)"> 選</th>
                <th>統編</th>
                <th>公司/單位</th>
                <th>姓名/職稱</th>
                <th>聯繫方式</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody id="data-table">
            <tr>
                <td><input type="checkbox" class="row-checkbox" value="ID_001" onclick="updateUI()"></td>
                <td>89627033</td>
                <td>二十一世紀生活事業<br><small>總經理室</small></td>
                <td>賴美絨<br><small>總經理</small></td>
                <td>02-27989868<br>lailai@pec21c.com.tw</td>
                <td><button class="btn btn-blue" style="padding:4px 8px">改</button></td>
            </tr>
            <tr>
                <td><input type="checkbox" class="row-checkbox" value="ID_002" onclick="updateUI()"></td>
                <td>89627033</td>
                <td>二十一世紀生活事業<br><small>後勤暨職安管理team</small></td>
                <td>廖方瑜<br><small>Team經理</small></td>
                <td>02-27989868<br>stella@pec21c.com.tw</td>
                <td><button class="btn btn-blue" style="padding:4px 8px">改</button></td>
            </tr>
        </tbody>
    </table>

    <script>
        // 1. 全選/取消全選功能
        function toggleAll(masterCheckbox) {
            const checkboxes = document.querySelectorAll('.row-checkbox');
            checkboxes.forEach(cb => {
                cb.checked = masterCheckbox.checked;
            });
            updateUI();
        }

        // 2. 更新 UI 狀態 (顯示/隱藏批次列、計算選取數)
        function updateUI() {
            const checkboxes = document.querySelectorAll('.row-checkbox');
            const selectedBoxes = document.querySelectorAll('.row-checkbox:checked');
            const batchBar = document.getElementById('batch-bar');
            const countSpan = document.getElementById('selected-count');
            const selectAllBox = document.getElementById('select-all');

            // 顯示選中數量
            countSpan.innerText = selectedBoxes.length;

            // 如果有選中任何東西，顯示批次列
            if (selectedBoxes.length > 0) {
                batchBar.style.display = 'flex';
            } else {
                batchBar.style.display = 'none';
            }

            // 如果全部手動勾選，自動把「全選」框勾起來
            selectAllBox.checked = (selectedBoxes.length === checkboxes.length);

            // 選中的行變色效果
            checkboxes.forEach(cb => {
                const row = cb.closest('tr');
                if (cb.checked) {
                    row.classList.add('selected-row');
                } else {
                    row.classList.remove('selected-row');
                }
            });
        }

        // 3. 批次刪除功能
        function batchDelete() {
            const selectedBoxes = document.querySelectorAll('.row-checkbox:checked');
            const ids = Array.from(selectedBoxes).map(cb => cb.value);

            if (confirm(`確定要刪除這 ${ids.length} 筆資料嗎？刪除後無法復原！`)) {
                alert("正在執行刪除動作，傳送 ID 清單: " + ids.join(', '));
                // 這裡放置您的後端刪除 API 代碼
                location.reload(); // 重新整理頁面模擬重新讀取
            }
        }

        // 4. 批次匯出功能 (範例)
        function batchExport() {
            const selectedBoxes = document.querySelectorAll('.row-checkbox:checked');
            alert(`準備匯出這 ${selectedBoxes.length} 筆選取的資料...`);
        }

        // 5. 安全清空資料庫 (防誤觸)
        function safeClearDatabase() {
            const userInput = prompt("⚠️ 警告：這將刪除「所有」資料！\n請輸入「確認清空」來執行此操作：");
            if (userInput === "確認清空") {
                alert("資料庫已清空 (模擬行為)");
            } else if (userInput !== null) {
                alert("輸入不正確，已取消操作。");
            }
        }
    </script>
</body>
</html>
